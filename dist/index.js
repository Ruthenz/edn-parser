function n(n,r){return void 0===n&&(n=""),void 0===r&&(r=1),n.length?"\n".concat(n.repeat(r)):""}function r(n){return void 0!==n}function e(n,r){var e=r.msg,t=r.action;if(!n)if(t)t();else if(e)throw new Error(e)}function t(n){var r=0,t=i();return function(){if(r<n.length)throw E("Expecting to end here"),new SyntaxError("EDN_ERROR_0002 Expected End of Input")}(),t;function i(){var t,a,p,v,E;u();var g=null!==(E=null!==(v=null!==(p=null!==(a=null!==(t=o())&&void 0!==t?t:function(){var e,t=r;"-"===n[r]&&(r++,s(n.slice(t,r)));if("0"===n[r])r++;else if(n[r]>="1"&&n[r]<="9")for(r++;n[r]>="0"&&n[r]<="9";)r++;if("/"===n[r])for(e=r,r++,s(n.slice(t,r));n[r]>="0"&&n[r]<="9";)r++;else if("."===n[r]){for(r++,s(n.slice(t,r));n[r]>="0"&&n[r]<="9";)r++;if("e"===n[r]||"E"===n[r])for(r++,"-"!==n[r]&&"+"!==n[r]||r++,s(n.slice(t,r));n[r]>="0"&&n[r]<="9";)r++}if(r>t){return e?Number(n.slice(t,e))/Number(n.slice(e+1,r)):Number(n.slice(t,r))}}())&&void 0!==a?a:function(){if("true"===n.slice(r,r+4))return r+=4,!0;if("false"===n.slice(r,r+5))return r+=5,!1}())&&void 0!==p?p:function(){var e={"[":"]","(":")"},t=n[r],o=e[t];if(o){r++,u();for(var c=[],a=!0;r<n.length&&n[r]!==o;){a||u();var l=i();c.push(l),a=!1}return f(o),r++,c}}())&&void 0!==v?v:function(){var t;if("{"===n[r]){r++,u();for(var a={},s=!0;r<n.length&&"}"!==n[r];){s||u();var p=null!==(t=o())&&void 0!==t?t:c();e(void 0!==p,{action:l}),u();var v=i();a[p]=v,s=!1}return f("}"),r++,a}}())&&void 0!==E?E:function(){var e="nil";if(n.slice(r,r+e.length)===e)return r+=e.length,null}();return u(),g}function o(){if('"'===n[r]){r++;for(var e="";r<n.length&&'"'!==n[r];){if("\\"===n[r]){var t=n[r+1];'"'===t||"\\"===t||"/"===t||"b"===t||"f"===t||"n"===t||"r"===t||"t"===t?(e+=t,r++):"u"===t?a(n[r+2])&&a(n[r+3])&&a(n[r+4])&&a(n[r+5])?(e+=String.fromCharCode(parseInt(n.slice(r+2,r+6),16)),r+=5):(r+=2,v(e)):p(e)}else e+=n[r];r++}return f('"'),r++,e}}function c(){if(":"===n[r]){r++;for(var e="";r<n.length&&" "!==n[r];)e+=n[r],r++;return f(" "),r++,e}}function a(n){return n>="0"&&n<="9"||n.toLowerCase()>="a"&&n.toLowerCase()<="f"}function u(){for(var e=[" ",",","\n","\t","\r"];e.includes(n[r]);)r++}function f(e){if(r===n.length)throw E("Expecting a `".concat(e,"` here")),new SyntaxError("EDN_ERROR_0001 Unexpected End of Input")}function l(){throw E('Expecting object key here\n\nFor example:\n{ "foo" "bar" }\n{ :foo "bar" }\n  ^^^^^'),new SyntaxError("EDN_ERROR_0003 Expecting EDN Key")}function s(e){if(!(n[r]>="0"&&n[r]<="9"))throw E("EDN_ERROR_0004 Expecting a digit here\n\nFor example:\n".concat(e,"5\n").concat(" ".repeat(e.length),"^")),new SyntaxError("EDN_ERROR_0005 Expecting a digit")}function p(n){throw E('EDN_ERROR_0006 Expecting escape character\n\nFor example:\n"'.concat(n,'\\n"\n').concat(" ".repeat(n.length+1),'^^\nList of escape characters are: \\", \\\\, \\/, \\b, \\f, \\n, \\r, \\t, \\u')),new SyntaxError("EDN_ERROR_0007 Expecting an escape character")}function v(n){throw E('Expect escape unicode\n\nFor example:\n"'.concat(n,"\\u0123\n").concat(" ".repeat(n.length+1),"^^^^^^")),new SyntaxError("EDN_ERROR_0008 Expecting an escape unicode")}function E(e){var t=Math.max(0,r-10),i=t>0,o=r-t+(i?4:0),c=[(i?"... ":"")+n.slice(t,r+1)," ".repeat(o)+"^"," ".repeat(o)+e].join("\n");console.log(c)}}var i=function(){function e(){}return e.parse=function(n){return t(n)},e.stringify=function(e,t){return function(e,t){var i=(void 0===t?{spaces:0}:t).spaces,o=void 0===i?0:i,c=" ".repeat(o);return function e(t,i){void 0===i&&(i=1);var a=typeof t;if(void 0!==t){if(null===t)return"nil";if("number"===a||"boolean"===a)return"".concat(t);if("string"===a)return'"'.concat(t,'"');var u=n(c,i),f=n(c,i-1),l=o?u:" ";if(Array.isArray(t))return t.length?["[",u,t.filter(r).map((function(n){return e(n,i+1)})).join(l),f,"]"].join(""):"[]";var s=Object.entries(t).filter((function(n){return n[0],r(n[1])})).map((function(n){var r=n[0],t=n[1];return":".concat(r," ").concat(e(t,i+1))}));return["{",u,s.join(l),f,"}"].join("")}}(e)}(e,t)},e.compress=function(n){return n.trim().replaceAll("\n","").replace(/\s\s+/g," ").replace(/(\(|\))(?=([^"]*"[^"]*")*[^"]*$)/g,(function(n){return"("===n?"[":"]"})).replace(/({ | }|\[ | \])(?=([^"]*"[^"]*")*[^"]*$)/g,(function(n){return n.trim()}))},e}();export{i as EDN,i as default};
